# Frontend web
## delete build folder
flutter clean
## generate boilerplate code
flutter pub get ; flutter pub run build_runner build --delete-conflicting-outputs 
## build web artifacts
flutter build web
## move web artifacts to backend folder for hosting ( docker junction issue )
Xcopy .\build\web\ ..\..\backend\public /E /H /C /I
## host web artifacts locally
http-server .\build\web\ -p 80 

# Frontend android
## delete build folder
flutter clean
## build android apk
flutter build apk

# Backend
## to start mongoDB container
docker-compose up 
## to start nodejs
npm start
## to install dependency
npm install
## to install nodemon CLI globally
npm install -g nodemon


# Azure
## login to azure container registry
docker login  myschoolerp.azurecr.io 
# password you find it in, go to azure home page then to container registry => access keys
# build image localy
docker build -t myschoolerp.azurecr.io/node-docker-demo:latest .
# run the image and forward the port 3000 
docker run -d -p 3000:3000 myschoolerp.azurecr.io/node-docker-demo
# push local image to azure container registry
docker push myschoolerp.azurecr.io/node-docker-demo:latest
# go to app service => container settings => enable continuous deployment, this will refresh app service each time you push a docker container to azure container registry

# Firebase 
## assign remote firebase to local folder
firebase init
## pushing local web artifacts to firebase hosting
firebase deploy --only hosting 

#git .gitignore issue ....
git rm -r --cached .\build\

# to build apk + web
docker-compose -f docker-compose-build.yml up

# to run backend( Node.js + MongoDB ) + frontend on localhost 
docker-compose -f docker-compose-run.yml up

#once you are in mongoDB container, run this command to backup database
mongodump --host 127.0.0.1 --port 27017 --db $MONGO_INITDB_DATABASE  --authenticationDatabase admin --username $MONGO_INITDB_ROOT_USERNAME --password $MONGO_INITDB_ROOT_PASSWORD --out .

#to get id of mongodb container
docker container ls

#to get backup from the running container into local storage
docker cp 51d42b522921:/tmp .tmp/
https://stackoverflow.com/questions/18931668/how-to-restore-the-dump-into-your-running-mongodb
mongorestore --db databasename --verbose \path\dump\<dumpfolder>


"For Windows 10 Home (alternative Optimize-VHD cmdlet):
c:\Users\Salim\AppData\Local\Docker\wsl\data\
wsl --shutdown
diskpart
# open window Diskpart
select vdisk file="c:\Users\Salim\AppData\Local\Docker\wsl\data\"
attach vdisk readonly
compact vdisk
detach vdisk
exit